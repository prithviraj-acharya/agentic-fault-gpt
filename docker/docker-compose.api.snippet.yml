# Compose snippet (merge into your existing docker-compose file)
# Assumes your Kafka service is named `kafka` and exposes listener `kafka:29092`.

services:
  dashboard-api:
    build:
      context: ..
      dockerfile: Dockerfile.api
    ports:
      - "8000:8000"
    environment:
      KAFKA_BOOTSTRAP_SERVERS: "kafka:29092"
      KAFKA_TELEMETRY_TOPICS: "ahu.telemetry"
      KAFKA_WINDOW_TOPICS: "window_summaries"
      KAFKA_AUTO_OFFSET_RESET: "latest"
      KAFKA_CONSUMER_GROUP_PREFIX: "dashboard-api"
      KAFKA_REPLAY_ON_STARTUP: "0"
      TELEMETRY_RETENTION_MINS: "30"
      WINDOWS_MAXLEN: "500"
      ONLINE_THRESHOLD_SECS: "15"
      MAX_POINTS: "2000"
      MAX_MINS: "120"
      MAX_LIMIT: "200"
      LOG_LEVEL: "INFO"
      CORS_ORIGINS: "*"
    depends_on:
      - kafka
